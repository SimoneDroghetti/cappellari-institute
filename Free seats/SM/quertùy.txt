SELECT TOP (1000) [RoomID]
      ,[SeatID]
      ,[RowNumber]
      ,[SeatNumber]
      ,[Taken]
  FROM [dbo].[RoomsAndSeats]


WITH postiliberi AS (

  SELECT
    *,
   ROW_NUMBER() OVER (PARTITION BY RowNumber ORDER BY SeatNumber ) AS grp
  FROM [dbo].[RoomsAndSeats]
  WHERE taken = 0
),
counted AS (
  SELECT
    *,
    COUNT(*) OVER ( PARTITION BY Rownumber, SeatNumber - grp ) AS cnt
  FROM postiliberi
)
SELECT
  RowNumber,
  SeatNumber

FROM counted
WHERE cnt >=40
ORDER BY RowNumber, SeatNumber;